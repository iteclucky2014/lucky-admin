/** layuiAdmin.pro-v1.1.0 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(["admin","table","treeSelect","laydate"],function(e){var a=layui.$,t=layui.admin,r=layui.view,i=layui.table,l=(layui.treeSelect,layui.laydate,layui.element,layui.form),n=layui.data(layui.setter.tableName);i.render({elem:"#layuiadmin-reporter-list",url:"/platform/device/reporter/page?access_token="+n.access_token,cols:[[{field:"username",width:300,align:"left",title:"报表类型"},{field:"realName",align:"left",title:"报表名称"},{field:"url",hide:!0},{title:"操作",width:200,align:"center",toolbar:"#layuiadmin-reporter-operate"}]],text:"数据加载异常！"}),i.on("tool(layuiadmin-reporter-list)",function(e){var o=e.data;"del"===e.event?layer.confirm("确定删除此用户吗？",function(e){var t=[];t.push(o.id);var r=layer.msg("处理中",{icon:16,shade:.01,time:0});a.ajax({url:"/platform/user/delete?access_token="+n.access_token,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({userid:"10001",username:"admin",data:t}),dataType:"json",success:function(e){0===e.code?(layer.close(r),i.reload("layuiadmin-reporter-list"),layer.msg("已删除")):layer.msg(e.msg,{icon:6})},error:function(e){layer.msg(e.msg,{icon:6})}})}):"edit"===e.event?a.getJSON("/platform/role/page?page=1&limit=100&access_token="+n.access_token,function(e){t.popup({title:"编辑管理员",area:["500px","600px"],id:"LAY-popup-user-add",success:function(t,i){r(this.id).render("user/administrators/adminform",o).done(function(){l.render(null,"layuiadmin-form-admin");var t=e.data||[];t.forEach(function(e){a("#LAY-popup-user-add-roles-checkbox").append('<input type="checkbox" name="platformRoles[]" title="'+e.roleName+'" value="'+e.id+'" lay-skin="primary">')});var r=[];o.authorities.forEach(function(e){r.push(e.id)}),a("#LAY-popup-user-add-roles-checkbox input").each(function(){a.inArray(parseInt(a(this).val()),r)!=-1?a(this).prop("checked",!0):a(this).prop("checked",!1)}),l.render("checkbox"),l.on("submit(LAY-user-back-submit)",function(e){var t=e.field,r=[];for(var l in t)l.indexOf("platformRoles[")!=-1&&r.push(t[l]);t.platformRoles=r;var o=layer.msg("处理中",{icon:16,shade:.01,time:0});a.ajax({url:"/platform/user/save?access_token="+n.access_token,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({userid:"10001",username:"admin",data:t}),dataType:"json",success:function(e){0===e.code?(layer.close(o),layui.table.reload("layuiadmin-reporter-list"),layer.close(i)):layer.msg(e.msg,{icon:6})},error:function(e){layer.msg(e.msg,{icon:6})}})})})}})}):"file"===e.event&&window.open("../../../platform/start/pdfjs/web/viewer.html?file="+o.url)}),e("reporter",{})});