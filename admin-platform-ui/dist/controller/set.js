/** layuiAdmin.pro-v1.1.0 LPPL License By http://www.layui.com/admin/ */
 ;layui.define(["form","upload"],function(e){var a=layui.$,t=layui.layer,s=(layui.laytpl,layui.setter),n=(layui.view,layui.admin),i=layui.form,o=layui.upload;a("body");i.render(),i.verify({nickname:function(e,a){return new RegExp("^[a-zA-Z0-9_一-龥\\s·]+$").test(e)?/(^\_)|(\__)|(\_+$)/.test(e)?"用户名首尾不能出现下划线'_'":/^\d+\d+\d$/.test(e)?"用户名不能全为数字":void 0:"用户名不能有特殊字符"},pass:[/^[\S]{6,12}$/,"密码必须6到12位，且不能出现空格"],repass:function(e){if(e!==a("#LAY_password").val())return"两次密码输入不一致"}}),i.on("submit(set_website)",function(e){return t.msg(JSON.stringify(e.field)),!1}),i.on("submit(set_system_email)",function(e){return t.msg(JSON.stringify(e.field)),!1}),i.on("submit(setmyinfo)",function(e){var n=e.field,i=t.msg("处理中",{icon:16,shade:.01,time:0}),o=layui.data(s.tableName),r=o.username;return n.username=r,a.ajax({url:"/platform/user/setmyinfo?access_token="+o.access_token,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({username:r,data:n}),dataType:"json",success:function(e){0===e.code?(t.close(i),t.msg(e.msg,{icon:6})):t.msg(e.msg,{icon:6})},error:function(e){t.msg("系统错误，请联系管理员。",{icon:6})}}),!1});var r=a("#LAY_avatarSrc");o.render({url:"/api/upload/",elem:"#LAY_avatarUpload",done:function(e){0==e.status?r.val(e.url):t.msg(e.msg,{icon:5})}}),n.events.avartatPreview=function(e){var a=r.val();t.photos({photos:{title:"查看头像",data:[{src:a}]},shade:.01,closeBtn:1,anim:5})},i.on("submit(setmypass)",function(e){var n=e.field,i=t.msg("处理中",{icon:16,shade:.01,time:0}),o=layui.data(s.tableName),r=o.username;return n.username=r,a.ajax({url:"/platform/user/changepw?access_token="+o.access_token,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({username:r,data:n}),dataType:"json",success:function(e){0===e.code?(t.close(i),t.msg(e.msg,{icon:6})):t.msg(e.msg,{icon:6})},error:function(e){t.msg("系统错误，请联系管理员。",{icon:6})}}),!1}),e("set",{})});