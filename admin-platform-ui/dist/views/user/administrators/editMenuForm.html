

<div class="layui-form" lay-filter="layuiadmin-form-admin" style="padding: 20px 30px 0 0;">
  <div class="layui-form-item">
    <label class="layui-form-label"><span style="color:red; font-size: 20px;">*</span>菜单ID</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="id" value="{{ d.params.id || '' }}" readonly autocomplete="off" class="layui-input"/>
      </script>
    </div>
  </div>
  <!--<div class="layui-form-item">-->
    <!--<label class="layui-form-label">父菜单ID</label>-->
    <!--<div class="layui-input-inline">-->
      <!--<script type="text/html" template>-->
        <!--<input type="text" name="pid" value="{{ d.params.pid || '' }}" placeholder="请输入" autocomplete="off" class="layui-input" />-->
      <!--</script>-->
    <!--</div>-->
  <!--</div>-->
  <div class="layui-form-item">
    <label class="layui-form-label">父菜单</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input id="pid" type="hidden" name="pid" value="{{ d.params.pid || '' }}" />
        <input id="pName" type="text" name="pName" lay-filter="menuTree" value="" />
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label"><span style="color:red; font-size: 20px;">*</span>菜单名称</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="name" value="{{ d.params.name || '' }}" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label"><i style="color:red; font-size: 20px;">*</i>菜单标题</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="title" value="{{ d.params.title || '' }}" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">菜单图标</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="icon" value="{{ d.params.icon || '' }}" placeholder="请输入" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">菜单跳转</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="jump" value="{{ d.params.jump || '' }}" placeholder="请输入" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">显示顺序</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="dispOrder" value="{{ d.params.dispOrder || '' }}" placeholder="请输入" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">角色</label>
    <div class="layui-input-inline">
        <div id="LAY-popup-user-add-roles-checkbox"></div>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label"></label>
    <div class="layui-input-inline">
      <input type="button" lay-submit lay-filter="LAY-user-back-submit" value="确认" class="layui-btn">
    </div>
  </div>
</div>

<script>
layui.use(['admin', 'form', 'treeSelect'], function(){
    var $ = layui.$
        ,treeSelect = layui.treeSelect
        ,form = layui.form;

    var localData = layui.data(layui.setter.tableName);

    treeSelect.render({
        // 选择器
        elem: '#pName',
        // 数据
        data: '/platform/menu/getMenuTreeData?access_token='+localData["access_token"],
        // 异步加载方式：get/post，默认get
        type: 'get',
        // 占位符
        placeholder: '修改默认提示信息',
        // 是否开启搜索功能：true/false，默认false
        search: true,
        // 点击回调
        click: function(d){
            console.log(d.current.id);
            $('#pid').val(d.current.id);
            console.log($('#pid').val());
        },
        // 加载完成后的回调函数
        success: function (d) {
            console.log(d);
            // 选中节点，根据id筛选
            treeSelect.checkNode('menuTree', $('#pid').val());

//                获取zTree对象，可以调用zTree方法
//                var treeObj = treeSelect.zTree('tree');
//                console.log(treeObj);

//                刷新树结构
//                treeSelect.refresh();
        }
    });



});
</script>