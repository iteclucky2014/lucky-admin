

<div class="layui-form" lay-filter="layuiadmin-form-admin" style="padding: 20px 30px 0 0;">
  <div class="layui-form-item">
    <label class="layui-form-label"><span style="color:red; font-size: 20px;">*</span>登录名</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="hidden" name="id" value={{ d.params.id || '' }} >
        <input type="text" name="username" value="{{ d.params.username || '' }}" lay-verify="required" placeholder="请输入用户名" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
      <label class="layui-form-label"><span style="color:red; font-size: 20px;">*</span>密码</label>
      <div class="layui-input-inline">
        <script type="text/html" template>
          <input type="text" name="password" value="{{ d.params.password || '' }}" lay-verify="required" placeholder="请输入用户名" autocomplete="off" class="layui-input">
        </script>
      </div>
    </div>
  <div class="layui-form-item">
      <label class="layui-form-label"><i style="color:red; font-size: 20px;">*</i>姓名</label>
      <div class="layui-input-inline">
        <script type="text/html" template>
          <input type="text" name="realName" value="{{ d.params.realName || '' }}" lay-verify="required" placeholder="请输入姓名" autocomplete="off" class="layui-input">
        </script>
      </div>
    </div>
  <div class="layui-form-item">
    <label class="layui-form-label"><span style="color:red; font-size: 20px;">*</span>手机</label>
    <div class="layui-input-inline">
      <script type="text/html" template>
        <input type="text" name="tel" value="{{ d.params.tel || '' }}" lay-verify="phone" placeholder="请输入手机号码" autocomplete="off" class="layui-input">
      </script>
    </div>
  </div>
  <div class="layui-form-item">
      <label class="layui-form-label">所属部门</label>
      <div class="layui-input-inline">
        <script type="text/html" template>
          <input id="deptId" type="hidden" name="deptId" value="{{ d.params.dept ? d.params.dept.id : '' || '' }}" />
          <input id="deptName" type="text" name="deptName" lay-filter="deptTree" value="{{ d.params.dept ? d.params.dept.deptName : '' || '' }}" />
        </script>
      </div>
    </div>
  <div class="layui-form-item">
    <label class="layui-form-label">角色</label>
    <div class="layui-input-inline">
        <div id="LAY-popup-user-add-roles-checkbox"></div>
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label"></label>
    <div class="layui-input-inline">
      <input type="button" lay-submit lay-filter="LAY-user-back-submit" value="确认" class="layui-btn">
    </div>
  </div>
</div>

<script>
layui.use(['admin', 'form', 'treeSelect'], function(){
  var $ = layui.$
  ,treeSelect = layui.treeSelect
  ,form = layui.form;

    var localData = layui.data(layui.setter.tableName);

    treeSelect.render({
        // 选择器
        elem: '#deptName',
        // 数据
        data: '/platform/dept/getDeptTreeData?access_token='+localData["access_token"],
        // 异步加载方式：get/post，默认get
        type: 'get',
        // 占位符
        placeholder: '修改默认提示信息',
        // 是否开启搜索功能：true/false，默认false
        search: true,
        // 点击回调
        click: function(d){
            console.log(d.current.id);
            $('#deptId').val(d.current.id);
            console.log($('#deptId').val());
        },
        // 加载完成后的回调函数
        success: function (d) {
            console.log(d);
            // 选中节点，根据id筛选
            treeSelect.checkNode('deptTree', $('#deptId').val());

//                获取zTree对象，可以调用zTree方法
//                var treeObj = treeSelect.zTree('tree');
//                console.log(treeObj);

//                刷新树结构
//                treeSelect.refresh();
        }
    });

});
</script>